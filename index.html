<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Dental Assistant Pro - ãƒ‡ãƒ¢ç‰ˆ</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Noto Sans JP',sans-serif;background:#f8fafc;color:#1e293b;-webkit-font-smoothing:antialiased;overflow-x:hidden}
.app{max-width:430px;margin:0 auto;min-height:100vh;position:relative}
/* Header */
.header{position:sticky;top:0;z-index:40;background:rgba(255,255,255,0.92);backdrop-filter:blur(12px);border-bottom:1px solid #e2e8f0;padding:0 16px;height:56px;display:flex;align-items:center;justify-content:space-between}
.header-left{display:flex;align-items:center;gap:8px}
.header-left span.logo{font-size:20px}
.header-left span.name{font-weight:700;font-size:13px;color:#1e293b}
.header-right{display:flex;align-items:center;gap:8px}
.header-avatar{font-size:18px}
.header-user{text-align:right}
.header-user .uname{font-size:11px;font-weight:600;color:#334155}
.header-user .urole{font-size:9px;color:#94a3b8}
/* Bottom Nav */
.bottom-nav{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:430px;background:rgba(255,255,255,0.95);backdrop-filter:blur(12px);border-top:1px solid #e2e8f0;display:flex;z-index:40;padding:4px 0 env(safe-area-inset-bottom,8px)}
.nav-item{flex:1;display:flex;flex-direction:column;align-items:center;padding:6px 0;cursor:pointer;transition:all 0.15s;border-radius:8px;margin:0 2px}
.nav-item:active{transform:scale(0.95)}
.nav-item .icon{font-size:18px;line-height:1}
.nav-item .label{font-size:9px;margin-top:2px;color:#94a3b8;font-weight:500}
.nav-item.active .label{color:#0284c7;font-weight:700}
.nav-item.active{background:rgba(2,132,199,0.06)}
/* Main */
.main{padding:16px 16px 96px}
/* Cards */
.card{background:#fff;border-radius:12px;border:1px solid #e2e8f0;padding:12px;margin-bottom:8px}
.card:active{transform:scale(0.995)}
.card-title{font-size:13px;font-weight:700;color:#1e293b}
.card-sub{font-size:11px;color:#94a3b8;margin-top:2px}
.card-body{font-size:12px;color:#475569;margin-top:6px;line-height:1.6}
/* Badges */
.badge{display:inline-block;font-size:10px;padding:2px 8px;border-radius:99px;font-weight:600}
.badge-sky{background:#e0f2fe;color:#0369a1}
.badge-red{background:#fee2e2;color:#dc2626}
.badge-amber{background:#fef3c7;color:#d97706}
.badge-green{background:#dcfce7;color:#16a34a}
.badge-purple{background:#f3e8ff;color:#7c3aed}
.badge-pink{background:#fce7f3;color:#db2777}
.badge-slate{background:#f1f5f9;color:#64748b}
/* Buttons */
.btn{padding:8px 14px;border-radius:10px;font-size:12px;font-weight:700;border:none;cursor:pointer;transition:all 0.15s}
.btn:active{transform:scale(0.97)}
.btn-primary{background:#0284c7;color:#fff}
.btn-primary:hover{background:#0369a1}
.btn-outline{background:#fff;color:#475569;border:1px solid #e2e8f0}
.btn-danger{background:#fee2e2;color:#dc2626}
.btn-sm{padding:5px 10px;font-size:10px}
/* Stats Grid */
.stats-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:12px}
.stat-card{border-radius:12px;padding:10px;text-align:center;border:1px solid}
.stat-card .num{font-size:18px;font-weight:700}
.stat-card .lbl{font-size:9px;margin-top:2px}
/* Search */
.search{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #e2e8f0;font-size:13px;background:#fff;outline:none}
.search:focus{border-color:#7dd3fc;box-shadow:0 0 0 3px rgba(125,211,252,0.3)}
/* Filter Pills */
.pills{display:flex;gap:6px;overflow-x:auto;padding-bottom:4px;margin:8px 0}
.pill{padding:6px 12px;border-radius:99px;font-size:11px;white-space:nowrap;cursor:pointer;border:1px solid #e2e8f0;background:#fff;color:#475569;font-weight:500}
.pill.active{background:#0284c7;color:#fff;border-color:#0284c7;font-weight:700}
/* Tags */
.tag{display:inline-block;font-size:9px;background:#f1f5f9;color:#94a3b8;padding:2px 6px;border-radius:99px;margin:1px}
/* Modal */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.5);backdrop-filter:blur(4px);z-index:60;display:flex;align-items:center;justify-content:center;padding:16px}
.modal{background:#fff;border-radius:16px;width:100%;max-width:400px;max-height:85vh;overflow-y:auto;padding:20px;box-shadow:0 20px 60px rgba(0,0,0,0.2)}
.modal-title{font-size:15px;font-weight:700;margin-bottom:12px}
/* Form */
.form-group{margin-bottom:10px}
.form-label{font-size:10px;color:#64748b;margin-bottom:4px;display:block;font-weight:500}
.form-input{width:100%;padding:8px 12px;border-radius:10px;border:1px solid #e2e8f0;font-size:13px;font-family:inherit;outline:none}
.form-input:focus{border-color:#7dd3fc;box-shadow:0 0 0 3px rgba(125,211,252,0.3)}
textarea.form-input{resize:none}
select.form-input{appearance:auto}
/* Toast */
.toast{position:fixed;top:80px;left:50%;transform:translateX(-50%);background:#1e293b;color:#fff;font-size:13px;font-weight:500;padding:10px 20px;border-radius:12px;z-index:80;box-shadow:0 8px 24px rgba(0,0,0,0.2);animation:toastIn 0.3s}
@keyframes toastIn{from{opacity:0;transform:translateX(-50%) translateY(-10px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}
/* Priority */
.priority-dot{width:6px;height:6px;border-radius:50%;display:inline-block;margin-right:4px}
.priority-high{background:#ef4444}
.priority-normal{background:#3b82f6}
.priority-low{background:#94a3b8}
/* Thank You Card */
.ty-card{background:linear-gradient(135deg,#fef3c7,#fce7f3);border-radius:16px;padding:14px;border:1px solid #fde68a;margin-bottom:8px}
.ty-emoji{font-size:28px}
.ty-msg{font-size:12px;color:#475569;margin-top:6px;line-height:1.6}
.ty-from{font-size:10px;color:#94a3b8;margin-top:6px}
/* Calendar */
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:2px}
.cal-header{text-align:center;font-size:10px;font-weight:600;color:#64748b;padding:4px}
.cal-day{text-align:center;padding:6px 2px;border-radius:8px;font-size:11px;cursor:pointer;min-height:36px}
.cal-day:hover{background:#f1f5f9}
.cal-day.today{background:#e0f2fe;font-weight:700;color:#0284c7}
.cal-day.has-shift{background:#dcfce7;border:1px solid #bbf7d0}
.cal-day.short{background:#fef3c7;border:1px solid #fde68a}
.cal-day.empty{color:#cbd5e1}
/* Progress */
.progress-bar{height:6px;background:#e2e8f0;border-radius:99px;overflow:hidden}
.progress-fill{height:100%;border-radius:99px;transition:width 0.3s}
/* Shift Timeline */
.shift-row{display:flex;align-items:center;gap:8px;padding:6px 0;border-bottom:1px solid #f1f5f9}
.shift-name{width:60px;font-size:11px;font-weight:600;color:#334155;flex-shrink:0}
.shift-bar-wrap{flex:1;height:20px;background:#f1f5f9;border-radius:4px;position:relative;overflow:hidden}
.shift-bar{position:absolute;top:2px;bottom:2px;border-radius:3px;font-size:8px;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:600}
/* Demo banner */
.demo-banner{background:linear-gradient(135deg,#0284c7,#7c3aed);color:#fff;padding:10px 16px;text-align:center;font-size:11px;font-weight:600;letter-spacing:0.5px}
.demo-badge{display:inline-block;background:rgba(255,255,255,0.2);padding:2px 8px;border-radius:99px;font-size:9px;margin-left:6px}
/* Tabs inside sections */
.sub-tabs{display:flex;gap:4px;margin-bottom:10px}
.sub-tab{flex:1;padding:7px;text-align:center;border-radius:10px;font-size:11px;font-weight:600;cursor:pointer;background:#f1f5f9;color:#64748b}
.sub-tab.active{background:#0284c7;color:#fff}
/* Table */
.tbl{width:100%;border-collapse:collapse;font-size:11px}
.tbl th{background:#f8fafc;padding:6px 8px;text-align:left;font-weight:600;color:#64748b;border-bottom:1px solid #e2e8f0}
.tbl td{padding:6px 8px;border-bottom:1px solid #f1f5f9}
/* Ranking */
.rank-item{display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid #f1f5f9}
.rank-medal{font-size:20px;width:30px;text-align:center}
.rank-name{font-size:12px;font-weight:600;flex:1}
.rank-count{font-size:12px;font-weight:700;color:#0284c7}
/* Inventory */
.inv-item{display:flex;align-items:center;gap:10px;padding:10px;background:#fff;border-radius:12px;border:1px solid #e2e8f0;margin-bottom:6px}
.inv-icon{font-size:24px}
.inv-info{flex:1}
.inv-name{font-size:12px;font-weight:600}
.inv-meta{font-size:10px;color:#94a3b8;margin-top:2px}
.inv-stock{text-align:right}
.inv-num{font-size:16px;font-weight:700}
.inv-unit{font-size:9px;color:#94a3b8}
/* Block content */
.block-img{width:100%;border-radius:10px;border:1px solid #e2e8f0;margin:8px 0}
.block-video{width:100%;border-radius:10px;border:1px solid #e2e8f0;margin:8px 0}
.block-text{font-size:12px;color:#475569;line-height:1.7;margin:4px 0}
/* Print */
@media print{.bottom-nav,.demo-banner,.header{display:none}.main{padding:0}}
/* Scrollbar */
::-webkit-scrollbar{width:4px}
::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}
</style>
</head>
<body>
<div class="app" id="app"></div>

<script>
// ============================================================
// DENTAL ASSISTANT PRO - DEMO VERSION
// ã‚µãƒ³ãƒ—ãƒ«æ­¯ç§‘ã‚¯ãƒªãƒ‹ãƒƒã‚¯
// ============================================================

// --- Mock Data ---
var STAFF = [
  { id: "s1", name: "å±±ç”° å¤ªéƒ", avatar: "ğŸ‘¨â€âš•ï¸", role: "admin", job: "æ­¯ç§‘åŒ»å¸«", joined: "2020-04-01" },
  { id: "s2", name: "ä½è—¤ èŠ±å­", avatar: "ğŸ‘©â€âš•ï¸", role: "staff", job: "æ­¯ç§‘è¡›ç”Ÿå£«", joined: "2021-06-15" },
  { id: "s3", name: "éˆ´æœ¨ ä¸€éƒ", avatar: "ğŸ§‘â€âš•ï¸", role: "staff", job: "æ­¯ç§‘æŠ€å·¥å£«", joined: "2022-01-10" },
  { id: "s4", name: "ç”°ä¸­ ç¾å’²", avatar: "ğŸ‘©", role: "staff", job: "å—ä»˜", joined: "2023-03-01" },
  { id: "s5", name: "é«˜æ©‹ å¥å¤ª", avatar: "ğŸ‘¨â€âš•ï¸", role: "staff", job: "æ­¯ç§‘åŒ»å¸«", joined: "2021-09-01" },
  { id: "s6", name: "ä¼Šè—¤ ã•ãã‚‰", avatar: "ğŸ‘©â€âš•ï¸", role: "staff", job: "æ­¯ç§‘è¡›ç”Ÿå£«", joined: "2023-08-01" }
];

var currentUser = STAFF[0]; // ç®¡ç†è€…ã§ãƒ­ã‚°ã‚¤ãƒ³

var ANNOUNCEMENTS = [
  { id: "a1", title: "å¹´æœ«å¹´å§‹ã®è¨ºç™‚ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¤ã„ã¦", body: "12/28(åœŸ)ã€œ1/5(æ—¥)ã¾ã§ä¼‘è¨ºã¨ã—ã¾ã™ã€‚12/27(é‡‘)ã¯åˆå‰è¨ºç™‚ã®ã¿ã§ã™ã€‚æ€¥æ‚£å¯¾å¿œã¯å½“ç•ªåŒ»ã‚’ã”ç¢ºèªãã ã•ã„ã€‚", author: "s1", priority: "high", is_pinned: true, category: "ãŠçŸ¥ã‚‰ã›", created_at: "2026-02-10T09:00:00", reactions: { "ğŸ‘": ["s2","s3"], "âœ…": ["s4","s5","s6"] }, reads: ["s1","s2","s3","s4","s5"] },
  { id: "a2", title: "æ–°ã—ã„æ»…èŒå™¨ã®ä½¿ç”¨æ–¹æ³•", body: "2Fæ»…èŒå®¤ã«æ–°å‹ã‚ªãƒ¼ãƒˆã‚¯ãƒ¬ãƒ¼ãƒ–ï¼ˆã‚¯ãƒ©ã‚¹Bï¼‰ã‚’å°å…¥ã—ã¾ã—ãŸã€‚å¾“æ¥æ©Ÿã¨æ“ä½œãŒç•°ãªã‚Šã¾ã™ã€‚ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚¿ãƒ–ã«æ‰‹é †æ›¸ã‚’æ²è¼‰ã—ã¾ã—ãŸã®ã§å¿…ãšç¢ºèªã—ã¦ãã ã•ã„ã€‚", author: "s1", priority: "normal", is_pinned: false, category: "æ¥­å‹™é€£çµ¡", created_at: "2026-02-09T14:30:00", reactions: { "ğŸ‘": ["s2","s6"] }, reads: ["s1","s2","s3"] },
  { id: "a3", title: "æ‚£è€…æ§˜ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã®å…±æœ‰", body: "1æœˆåˆ†ã®æ‚£è€…æº€è¶³åº¦ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚ç·åˆæº€è¶³åº¦ã¯4.2/5.0ã§å‰æœˆæ¯”+0.3ã§ã™ã€‚ã€Œå¾…ã¡æ™‚é–“ã€ã®é …ç›®ãŒæ”¹å–„ã—ã¦ã„ã¾ã™ã€‚è©³ç´°ã¯é™¢å†…ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§å…±æœ‰ã—ã¾ã™ã€‚", author: "s2", priority: "low", is_pinned: false, category: "ãŠçŸ¥ã‚‰ã›", created_at: "2026-02-08T11:00:00", reactions: { "ğŸ‘": ["s1","s5"] }, reads: ["s1","s2"] },
  { id: "a4", title: "ã€ç·Šæ€¥ã€‘æ°´é“å·¥äº‹ã«ã‚ˆã‚‹æ–­æ°´ã®ãŠçŸ¥ã‚‰ã›", body: "2/15(åœŸ)åˆå‰ä¸­ã€ãƒ“ãƒ«å…¨ä½“ã®æ°´é“å·¥äº‹ã®ãŸã‚æ–­æ°´ã¨ãªã‚Šã¾ã™ã€‚åˆå‰ã®äºˆç´„ã¯å‰æ—¥ã¾ã§ã«æ‚£è€…æ§˜ã¸ã”é€£çµ¡ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚ãƒšãƒƒãƒˆãƒœãƒˆãƒ«ã®æ°´ã‚’æº–å‚™ã—ã¦ãŠãã¾ã™ã€‚", author: "s1", priority: "high", is_pinned: true, category: "ç·Šæ€¥", created_at: "2026-02-11T08:00:00", reactions: { "ğŸš¨": ["s2","s3","s4","s5","s6"] }, reads: ["s1","s2","s3","s4","s5","s6"] }
];

var MEETINGS = [
  { id: "m1", title: "2æœˆå®šä¾‹ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°", date: "2026-02-14", time: "18:00", location: "ä¼‘æ†©å®¤", agenda: [
    { text: "å…ˆæœˆã®å£²ä¸Šå ±å‘Š", tag: "å ±å‘Š", done: false },
    { text: "æ–°äººç ”ä¿®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª", tag: "å…±æœ‰", done: false },
    { text: "æ‚£è€…ã‚¯ãƒ¬ãƒ¼ãƒ å¯¾å¿œã®æŒ¯ã‚Šè¿”ã‚Š", tag: "è­°è«–", done: false },
    { text: "3æœˆã®ã‚·ãƒ•ãƒˆå¸Œæœ›æå‡ºæœŸé™", tag: "æ±ºå®š", done: false }
  ], attendees: ["s1","s2","s3","s4","s5","s6"], author: "s1" },
  { id: "m2", title: "è¡›ç”Ÿå£«ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹", date: "2026-02-20", time: "12:30", location: "è¨ºç™‚å®¤2", agenda: [
    { text: "SRPç—‡ä¾‹æ¤œè¨", tag: "å ±å‘Š", done: false },
    { text: "æ–°ã—ã„ã‚¹ã‚±ãƒ¼ãƒ©ãƒ¼ã®è©•ä¾¡", tag: "è­°è«–", done: false }
  ], attendees: ["s2","s5","s6"], author: "s2" }
];

var HIYARIHATTO = [
  { id: "h1", title: "æ‚£è€…å–ã‚Šé•ãˆãã†ã«ãªã£ãŸ", body: "åŒå§“ã®æ‚£è€…ãŒåŒã˜æ™‚é–“å¸¯ã«äºˆç´„ã•ã‚Œã¦ãŠã‚Šã€ã‚«ãƒ«ãƒ†ã‚’å–ã‚Šé•ãˆãã†ã«ãªã£ãŸã€‚åå‰ã®ãƒ•ãƒ«ãƒãƒ¼ãƒ ç¢ºèªã¨ç”Ÿå¹´æœˆæ—¥ã®ç…§åˆã§æ°—ã¥ã„ãŸã€‚", category: "ç¢ºèªä¸è¶³", severity: "ä¸­", status: "å¯¾ç­–æ¸ˆ", created_at: "2026-02-05", anonymous: false, author: "s4" },
  { id: "h2", title: "è–¬æ¶²ã®æ¿ƒåº¦ãƒŸã‚¹", body: "æ¶ˆæ¯’æ¶²ã®å¸Œé‡ˆæ¿ƒåº¦ã‚’é–“é•ãˆã¦èª¿åˆã—ã‹ã‘ãŸã€‚ãƒ€ãƒ–ãƒ«ãƒã‚§ãƒƒã‚¯ä½“åˆ¶ãŒãªã‹ã£ãŸã“ã¨ãŒåŸå› ã€‚", category: "æ‰‹é †ãƒŸã‚¹", severity: "é«˜", status: "å¯¾ç­–ä¸­", created_at: "2026-02-08", anonymous: true, author: null }
];

var INVENTORY = [
  { id: "i1", name: "ã‚°ãƒ­ãƒ¼ãƒ–ï¼ˆMï¼‰", category: "æ¶ˆè€—å“", stock: 45, min_stock: 50, unit: "ç®±", price: 980, supplier: "ãƒ‡ãƒ³ã‚¿ãƒ«ã‚µãƒ—ãƒ©ã‚¤æ±äº¬", barcode: "4901234567890", last_used: "2026-02-10" },
  { id: "i2", name: "ã‚°ãƒ­ãƒ¼ãƒ–ï¼ˆSï¼‰", category: "æ¶ˆè€—å“", stock: 32, min_stock: 30, unit: "ç®±", price: 980, supplier: "ãƒ‡ãƒ³ã‚¿ãƒ«ã‚µãƒ—ãƒ©ã‚¤æ±äº¬", barcode: "4901234567891", last_used: "2026-02-10" },
  { id: "i3", name: "ã‚³ãƒ³ãƒã‚¸ãƒƒãƒˆãƒ¬ã‚¸ãƒ³ A2", category: "ææ–™", stock: 8, min_stock: 5, unit: "æœ¬", price: 3200, supplier: "æ­¯æãƒãƒƒãƒˆ", barcode: "4902345678901", last_used: "2026-02-09" },
  { id: "i4", name: "å°è±¡æï¼ˆã‚¢ãƒ«ã‚¸ãƒãƒ¼ãƒˆï¼‰", category: "ææ–™", stock: 3, min_stock: 5, unit: "è¢‹", price: 2400, supplier: "æ­¯æãƒãƒƒãƒˆ", barcode: "4902345678902", last_used: "2026-02-07" },
  { id: "i5", name: "ãƒ•ãƒƒç´ ãƒãƒ¼ãƒ‹ãƒƒã‚·ãƒ¥", category: "äºˆé˜²", stock: 12, min_stock: 10, unit: "æœ¬", price: 4500, supplier: "ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«ãƒ—ãƒ©ã‚¹", barcode: "4903456789012", last_used: "2026-02-08" },
  { id: "i6", name: "æ ¹ç®¡å……å¡«æ", category: "ææ–™", stock: 2, min_stock: 3, unit: "ç®±", price: 8900, supplier: "æ­¯æãƒãƒƒãƒˆ", barcode: "4903456789013", last_used: "2026-02-06" },
  { id: "i7", name: "éº»é…”ã‚«ãƒ¼ãƒˆãƒªãƒƒã‚¸", category: "è–¬å“", stock: 18, min_stock: 20, unit: "ç®±", price: 5600, supplier: "ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«ãƒ—ãƒ©ã‚¹", barcode: "4904567890123", last_used: "2026-02-11" },
  { id: "i8", name: "ã‚¨ãƒ—ãƒ­ãƒ³", category: "æ¶ˆè€—å“", stock: 60, min_stock: 30, unit: "æš", price: 120, supplier: "ãƒ‡ãƒ³ã‚¿ãƒ«ã‚µãƒ—ãƒ©ã‚¤æ±äº¬", barcode: "4904567890124", last_used: "2026-02-11" },
  { id: "i9", name: "ãƒã‚­ãƒ¥ãƒ¼ãƒ ãƒãƒƒãƒ—", category: "æ¶ˆè€—å“", stock: 5, min_stock: 10, unit: "è¢‹", price: 1800, supplier: "ãƒ‡ãƒ³ã‚¿ãƒ«ã‚µãƒ—ãƒ©ã‚¤æ±äº¬", barcode: "4905678901234", last_used: "2026-02-10" },
  { id: "i10", name: "ãƒœãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ", category: "ææ–™", stock: 6, min_stock: 3, unit: "æœ¬", price: 6700, supplier: "æ­¯æãƒãƒƒãƒˆ", barcode: "4905678901235", last_used: "2026-02-09" }
];

var SUPPLIERS = [
  { name: "ãƒ‡ãƒ³ã‚¿ãƒ«ã‚µãƒ—ãƒ©ã‚¤æ±äº¬", tel: "03-1234-5678", email: "order@dental-supply.example.com", fax: "03-1234-5679" },
  { name: "æ­¯æãƒãƒƒãƒˆ", tel: "06-9876-5432", email: "info@shizai-net.example.com", fax: "06-9876-5433" },
  { name: "ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«ãƒ—ãƒ©ã‚¹", tel: "045-111-2222", email: "sales@medical-plus.example.com", fax: "045-111-2223" }
];

var MANUALS = [
  { id: "mn1", title: "å—ä»˜æ¥­å‹™ãƒãƒ‹ãƒ¥ã‚¢ãƒ«", icon: "ğŸ“‹", category: "æ¥­å‹™æ‰‹é †", tags: ["å—ä»˜","åŸºæœ¬"], job_level: "å—ä»˜",
    blocks: [
      { type: "text", value: "## å—ä»˜ã®åŸºæœ¬æ¥­å‹™ãƒ•ãƒ­ãƒ¼\n\næ¥é™¢ã•ã‚ŒãŸæ‚£è€…æ§˜ã¸ã®å¯¾å¿œæ‰‹é †ã§ã™ã€‚ç¬‘é¡”ã§ä¸å¯§ãªå¯¾å¿œã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†ã€‚" },
      { type: "image", value: "https://placehold.co/400x200/e0f2fe/0284c7?text=å—ä»˜ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å†™çœŸ", name: "å—ä»˜ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼.jpg" },
      { type: "text", value: "### 1. æ‚£è€…æ§˜ã®ç¢ºèª\n- è¨ºå¯Ÿåˆ¸ã¾ãŸã¯ä¿é™ºè¨¼ã‚’å—ã‘å–ã‚‹\n- äºˆç´„æ™‚é–“ã‚’ç¢ºèª\n- åˆè¨ºã®å ´åˆã¯å•è¨ºç¥¨ã‚’è¨˜å…¥ã—ã¦ã„ãŸã ã\n\n### 2. ã‚«ãƒ«ãƒ†ã®æº–å‚™\n- é›»å­ã‚«ãƒ«ãƒ†ã‚’é–‹ã\n- å‰å›ã®æ²»ç™‚å†…å®¹ã‚’ç¢ºèª\n- ãƒ‰ã‚¯ã‚¿ãƒ¼ã¸ç”³ã—é€ã‚Š" },
      { type: "video", value: "https://placehold.co/400x225/f3e8ff/7c3aed?text=å—ä»˜å¯¾å¿œå‹•ç”»", name: "å—ä»˜å¯¾å¿œä¾‹.mp4" },
      { type: "text", value: "### 3. ä¼šè¨ˆå‡¦ç†\n- æ²»ç™‚è²»ã®è¨ˆç®—\n- é ˜åæ›¸ã®ç™ºè¡Œ\n- æ¬¡å›äºˆç´„ã®ç¢ºèª" }
    ], updated_at: "2026-02-01" },
  { id: "mn2", title: "æ»…èŒå™¨ï¼ˆã‚¯ãƒ©ã‚¹Bï¼‰æ“ä½œæ‰‹é †", icon: "ğŸ”¬", category: "æ©Ÿå™¨æ“ä½œ", tags: ["æ»…èŒ","è¡›ç”Ÿ"], job_level: "all",
    blocks: [
      { type: "text", value: "## ã‚¯ãƒ©ã‚¹Bã‚ªãƒ¼ãƒˆã‚¯ãƒ¬ãƒ¼ãƒ–æ“ä½œæ‰‹é †\n\næ–°å‹æ»…èŒå™¨ã®æ“ä½œæ–¹æ³•ã§ã™ã€‚å¿…ãšæ‰‹é †ã‚’å®ˆã£ã¦ãã ã•ã„ã€‚" },
      { type: "image", value: "https://placehold.co/400x200/dcfce7/16a34a?text=æ»…èŒå™¨ãƒ‘ãƒãƒ«å†™çœŸ", name: "æ»…èŒå™¨.jpg" },
      { type: "text", value: "### æ‰‹é †\n1. é›»æºONï¼ˆèƒŒé¢ã‚¹ã‚¤ãƒƒãƒï¼‰\n2. å™¨å…·ã‚’ãƒˆãƒ¬ãƒ¼ã«ä¸¦ã¹ã‚‹ï¼ˆé‡ã­ãªã„ï¼‰\n3. æ‰‰ã‚’ã—ã£ã‹ã‚Šé–‰ã‚ã‚‹\n4. ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€Œ134â„ƒ-18åˆ†ã€ã‚’é¸æŠ\n5. STARTãƒœã‚¿ãƒ³ã‚’æŠ¼ã™\n6. å®Œäº†éŸ³ãŒé³´ã‚‹ã¾ã§é–‹ã‘ãªã„" },
      { type: "image", value: "https://placehold.co/400x200/fef3c7/d97706?text=å™¨å…·é…ç½®ã®æ­£ã—ã„ä¾‹", name: "é…ç½®ä¾‹.jpg" },
      { type: "text", value: "âš ï¸ æ³¨æ„äº‹é …\n- ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯å™¨å…·ã¯121â„ƒãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½¿ç”¨\n- ç•°å¸¸éŸ³ãŒã—ãŸã‚‰å³åœæ­¢â†’å±±ç”°å…ˆç”Ÿã«å ±å‘Š" }
    ], updated_at: "2026-02-09" },
  { id: "mn3", title: "æ€¥æ‚£å¯¾å¿œãƒ•ãƒ­ãƒ¼", icon: "ğŸš¨", category: "ç·Šæ€¥å¯¾å¿œ", tags: ["æ€¥æ‚£","ç·Šæ€¥"], job_level: "all",
    blocks: [
      { type: "text", value: "## æ€¥æ‚£å¯¾å¿œã®åˆ¤æ–­åŸºæº–ã¨æ‰‹é †\n\næ€¥æ‚£ã®é€£çµ¡ãŒã‚ã£ãŸå ´åˆã®å¯¾å¿œãƒ•ãƒ­ãƒ¼ã§ã™ã€‚" },
      { type: "text", value: "### ç·Šæ€¥åº¦ã®åˆ¤æ–­\n- ğŸ”´ æœ€å„ªå…ˆï¼šå‡ºè¡€ãŒæ­¢ã¾ã‚‰ãªã„ã€å¼·ã„ç—›ã¿ã€è…«ã‚Œ\n- ğŸŸ¡ è¦å¯¾å¿œï¼šè©°ã‚ç‰©ãŒå–ã‚ŒãŸã€è»½ã„ç—›ã¿\n- ğŸŸ¢ äºˆç´„æ¡ˆå†…ï¼šå®šæœŸæ¤œè¨ºã€ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¸Œæœ›" }
    ], updated_at: "2026-01-20" }
];

var SHIFTS_FEB = {
  "2026-02-03": [{ staff: "s1", start: "9:00", end: "18:00" }, { staff: "s2", start: "9:00", end: "17:00" }, { staff: "s4", start: "9:00", end: "18:00" }],
  "2026-02-04": [{ staff: "s1", start: "9:00", end: "18:00" }, { staff: "s3", start: "10:00", end: "19:00" }, { staff: "s4", start: "9:00", end: "18:00" }, { staff: "s6", start: "9:00", end: "17:00" }],
  "2026-02-05": [{ staff: "s2", start: "9:00", end: "17:00" }, { staff: "s5", start: "9:00", end: "18:00" }, { staff: "s4", start: "9:00", end: "14:00" }],
  "2026-02-06": [{ staff: "s1", start: "9:00", end: "18:00" }, { staff: "s2", start: "9:00", end: "17:00" }, { staff: "s3", start: "10:00", end: "19:00" }, { staff: "s6", start: "9:00", end: "17:00" }],
  "2026-02-07": [{ staff: "s1", start: "9:00", end: "13:00" }, { staff: "s5", start: "9:00", end: "18:00" }, { staff: "s4", start: "9:00", end: "18:00" }],
  "2026-02-10": [{ staff: "s1", start: "9:00", end: "18:00" }, { staff: "s2", start: "9:00", end: "17:00" }, { staff: "s3", start: "10:00", end: "19:00" }, { staff: "s4", start: "9:00", end: "18:00" }, { staff: "s5", start: "9:00", end: "18:00" }],
  "2026-02-11": [{ staff: "s1", start: "9:00", end: "18:00" }, { staff: "s6", start: "9:00", end: "17:00" }, { staff: "s4", start: "9:00", end: "18:00" }],
  "2026-02-12": [{ staff: "s2", start: "9:00", end: "17:00" }, { staff: "s5", start: "9:00", end: "18:00" }, { staff: "s3", start: "10:00", end: "19:00" }],
  "2026-02-13": [{ staff: "s1", start: "9:00", end: "18:00" }, { staff: "s2", start: "9:00", end: "17:00" }, { staff: "s4", start: "9:00", end: "18:00" }, { staff: "s6", start: "9:00", end: "17:00" }],
  "2026-02-14": [{ staff: "s1", start: "9:00", end: "13:00" }, { staff: "s5", start: "9:00", end: "18:00" }],
  "2026-02-17": [{ staff: "s1", start: "9:00", end: "18:00" }, { staff: "s2", start: "9:00", end: "17:00" }, { staff: "s3", start: "10:00", end: "19:00" }, { staff: "s4", start: "9:00", end: "18:00" }],
  "2026-02-18": [{ staff: "s1", start: "9:00", end: "18:00" }, { staff: "s6", start: "9:00", end: "17:00" }, { staff: "s5", start: "9:00", end: "18:00" }],
  "2026-02-19": [{ staff: "s2", start: "9:00", end: "17:00" }, { staff: "s3", start: "10:00", end: "19:00" }, { staff: "s4", start: "9:00", end: "18:00" }],
  "2026-02-20": [{ staff: "s1", start: "9:00", end: "18:00" }, { staff: "s2", start: "9:00", end: "17:00" }, { staff: "s6", start: "9:00", end: "17:00" }],
  "2026-02-21": [{ staff: "s5", start: "9:00", end: "18:00" }, { staff: "s4", start: "9:00", end: "18:00" }]
};

var THANKYOU = [
  { id: "t1", from: "s4", to: "s2", message: "æ€¥æ‚£å¯¾å¿œã®ãƒ•ã‚©ãƒ­ãƒ¼ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼ãŠã‹ã’ã§ã‚¹ãƒ ãƒ¼ã‚ºã«æ¡ˆå†…ã§ãã¾ã—ãŸã€‚", emoji: "ğŸ™", created_at: "2026-02-10T16:30:00" },
  { id: "t2", from: "s2", to: "s1", message: "æ²»ç™‚è¨ˆç”»ã®ç›¸è«‡ã«ä¸å¯§ã«ã®ã£ã¦ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚å‹‰å¼·ã«ãªã‚Šã¾ã—ãŸï¼", emoji: "âœ¨", created_at: "2026-02-09T12:00:00" },
  { id: "t3", from: "s6", to: "s4", message: "ã‚·ãƒ•ãƒˆäº¤ä»£ã‚’å¿«ãå¼•ãå—ã‘ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ï¼åŠ©ã‹ã‚Šã¾ã—ãŸğŸ˜Š", emoji: "ğŸ’ª", created_at: "2026-02-08T18:00:00" },
  { id: "t4", from: "s3", to: "s1", message: "æŠ€å·¥ç‰©ã®ç´æœŸèª¿æ•´ã€è¿…é€Ÿã«å¯¾å¿œã—ã¦ã„ãŸã ãæ„Ÿè¬ã§ã™ã€‚", emoji: "ğŸŒŸ", created_at: "2026-02-07T10:00:00" },
  { id: "t5", from: "s1", to: "s6", message: "æ–°äººç ”ä¿®ã®è³‡æ–™ä½œæˆã‚ã‚ŠãŒã¨ã†ã€‚ã¨ã¦ã‚‚ã‚ã‹ã‚Šã‚„ã™ã‹ã£ãŸã§ã™ã€‚", emoji: "ğŸ’", created_at: "2026-02-06T17:00:00" },
  { id: "t6", from: "s5", to: "s2", message: "SRPã®ç—‡ä¾‹ã§ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚ã‚ŠãŒã¨ã†ã€‚æ¬¡å›ã‚‚ç›¸è«‡ã•ã›ã¦ãã ã•ã„ï¼", emoji: "ğŸ¤", created_at: "2026-02-05T15:00:00" }
];

var PAID_LEAVE = [
  { id: "s1", total: 20, used: 5, history: [{ date: "2026-01-06", days: 1, reason: "ç§ç”¨" }, { date: "2025-12-29", days: 3, reason: "å¹´æœ«å¸°çœ" }, { date: "2025-11-15", days: 1, reason: "é€šé™¢" }] },
  { id: "s2", total: 15, used: 3, history: [{ date: "2026-01-20", days: 2, reason: "æ—…è¡Œ" }, { date: "2025-10-10", days: 1, reason: "ç§ç”¨" }] },
  { id: "s3", total: 12, used: 1, history: [{ date: "2025-12-24", days: 1, reason: "ç§ç”¨" }] },
  { id: "s4", total: 10, used: 2, history: [{ date: "2026-02-03", days: 1, reason: "ä½“èª¿ä¸è‰¯" }, { date: "2025-11-22", days: 1, reason: "ç§ç”¨" }] },
  { id: "s5", total: 15, used: 4, history: [{ date: "2026-01-13", days: 2, reason: "å®¶åº­äº‹æƒ…" }, { date: "2025-12-02", days: 2, reason: "æ—…è¡Œ" }] },
  { id: "s6", total: 10, used: 0, history: [] }
];

// --- State ---
var state = {
  activeTab: "portal",
  subTab: "board",
  portalFilter: "all",
  invFilter: "all",
  invSearch: "",
  manualFilter: "all",
  manualSearch: "",
  selectedManual: null,
  shiftDate: null,
  shiftMonth: 1, // 0-indexed, Feb = 1
  shiftYear: 2026,
  tyTab: "received",
  staffSearch: "",
  leaveTab: "list",
  selectedAnnouncement: null,
  selectedMeeting: null,
  selectedHiyari: null,
  toast: null
};

function getStaff(id) { return STAFF.find(function(s){ return s.id === id; }) || { name: "ä¸æ˜", avatar: "ğŸ‘¤" }; }
function fmtDate(d) { var dt = new Date(d); return dt.getFullYear() + "/" + (dt.getMonth()+1) + "/" + dt.getDate(); }
function fmtDateTime(d) { var dt = new Date(d); return (dt.getMonth()+1) + "/" + dt.getDate() + " " + String(dt.getHours()).padStart(2,"0") + ":" + String(dt.getMinutes()).padStart(2,"0"); }
function showToast(msg) { state.toast = msg; render(); setTimeout(function(){ state.toast = null; render(); }, 2000); }

// --- Render Engine ---
function render() {
  var app = document.getElementById("app");
  var html = "";

  // Demo Banner
  html += '<div class="demo-banner">ğŸ¦· Dental Assistant Pro<span class="demo-badge">DEMO</span></div>';

  // Header
  html += '<div class="header"><div class="header-left"><span class="logo">ğŸ¦·</span><span class="name">ã‚µãƒ³ãƒ—ãƒ«æ­¯ç§‘ã‚¯ãƒªãƒ‹ãƒƒã‚¯</span></div><div class="header-right"><span class="header-avatar">' + currentUser.avatar + '</span><div class="header-user"><div class="uname">' + currentUser.name + '</div><div class="urole">ç®¡ç†è€…</div></div></div></div>';

  // Main
  html += '<div class="main">';
  
  if (state.activeTab === "portal") html += renderPortal();
  else if (state.activeTab === "inventory") html += renderInventory();
  else if (state.activeTab === "manual") html += renderManual();
  else if (state.activeTab === "shift") html += renderShift();
  else if (state.activeTab === "thankyou") html += renderThankYou();
  else if (state.activeTab === "staff") html += renderStaffManagement();
  
  html += '</div>';

  // Toast
  if (state.toast) html += '<div class="toast">' + state.toast + '</div>';

  // Bottom Nav
  var tabs = [
    { id: "portal", icon: "ğŸ“‹", label: "é€£çµ¡" },
    { id: "inventory", icon: "ğŸ“¦", label: "åœ¨åº«" },
    { id: "manual", icon: "ğŸ“–", label: "ãƒãƒ‹ãƒ¥ã‚¢ãƒ«" },
    { id: "shift", icon: "ğŸ“…", label: "ã‚·ãƒ•ãƒˆ" },
    { id: "thankyou", icon: "ğŸ’Œ", label: "Thanks" },
    { id: "staff", icon: "ğŸ‘¥", label: "ã‚¹ã‚¿ãƒƒãƒ•" }
  ];
  html += '<div class="bottom-nav">';
  for (var i = 0; i < tabs.length; i++) {
    var t = tabs[i];
    html += '<div class="nav-item' + (state.activeTab === t.id ? " active" : "") + '" onclick="switchTab(\'' + t.id + '\')"><div class="icon">' + t.icon + '</div><div class="label">' + t.label + '</div></div>';
  }
  html += '</div>';

  app.innerHTML = html;
}

function switchTab(id) { state.activeTab = id; state.selectedAnnouncement = null; state.selectedManual = null; state.selectedMeeting = null; state.selectedHiyari = null; render(); }

// ============================================================
// PORTAL TAB
// ============================================================
function renderPortal() {
  var h = '';
  // Sub tabs
  h += '<div class="sub-tabs">';
  h += '<div class="sub-tab' + (state.subTab === "board" ? " active" : "") + '" onclick="state.subTab=\'board\';render()">ğŸ“‹ é€£çµ¡</div>';
  h += '<div class="sub-tab' + (state.subTab === "meeting" ? " active" : "") + '" onclick="state.subTab=\'meeting\';render()">ğŸ¤ ä¼šè­°</div>';
  h += '<div class="sub-tab' + (state.subTab === "hiyari" ? " active" : "") + '" onclick="state.subTab=\'hiyari\';render()">âš ï¸ ãƒ’ãƒ¤ãƒª</div>';
  h += '</div>';

  if (state.subTab === "board") h += renderBoard();
  else if (state.subTab === "meeting") h += renderMeetings();
  else if (state.subTab === "hiyari") h += renderHiyari();
  return h;
}

function renderBoard() {
  var h = '';
  // Quick Stats
  var lowStock = INVENTORY.filter(function(i){ return i.stock < i.min_stock; });
  h += '<div class="stats-grid">';
  h += '<div class="stat-card" style="background:#fee2e2;border-color:#fecaca"><div class="num" style="color:#dc2626">' + lowStock.length + '</div><div class="lbl" style="color:#dc2626">åœ¨åº«ä¸è¶³</div></div>';
  h += '<div class="stat-card" style="background:#e0f2fe;border-color:#bae6fd"><div class="num" style="color:#0284c7">' + ANNOUNCEMENTS.length + '</div><div class="lbl" style="color:#0284c7">é€£çµ¡äº‹é …</div></div>';
  h += '<div class="stat-card" style="background:#dcfce7;border-color:#bbf7d0"><div class="num" style="color:#16a34a">' + STAFF.length + '</div><div class="lbl" style="color:#16a34a">ã‚¹ã‚¿ãƒƒãƒ•</div></div>';
  h += '</div>';

  // Filter
  h += '<div class="pills">';
  var cats = ["all","ãŠçŸ¥ã‚‰ã›","æ¥­å‹™é€£çµ¡","ç·Šæ€¥"];
  for (var i = 0; i < cats.length; i++) {
    var c = cats[i];
    var label = c === "all" ? "å…¨ã¦" : c;
    h += '<div class="pill' + (state.portalFilter === c ? " active" : "") + '" onclick="state.portalFilter=\'' + c + '\';render()">' + label + '</div>';
  }
  h += '</div>';

  // Detail view
  if (state.selectedAnnouncement) {
    var a = state.selectedAnnouncement;
    var author = getStaff(a.author);
    h += '<button class="btn btn-outline btn-sm" onclick="state.selectedAnnouncement=null;render()" style="margin-bottom:8px">â† ä¸€è¦§ã«æˆ»ã‚‹</button>';
    h += '<div class="card"><div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">';
    h += '<span class="priority-dot priority-' + a.priority + '"></span>';
    h += '<span class="badge badge-' + (a.priority==="high"?"red":a.priority==="normal"?"sky":"slate") + '">' + a.priority + '</span>';
    if (a.is_pinned) h += '<span class="badge badge-amber">ğŸ“Œ ãƒ”ãƒ³ç•™ã‚</span>';
    h += '</div>';
    h += '<div class="card-title" style="font-size:15px;margin-bottom:8px">' + a.title + '</div>';
    h += '<div class="card-body">' + a.body + '</div>';
    h += '<div style="margin-top:12px;padding-top:8px;border-top:1px solid #f1f5f9;display:flex;align-items:center;gap:6px">';
    h += '<span style="font-size:14px">' + author.avatar + '</span><span style="font-size:11px;color:#64748b">' + author.name + '</span>';
    h += '<span style="font-size:10px;color:#94a3b8;margin-left:auto">' + fmtDateTime(a.created_at) + '</span></div>';
    // Reactions
    h += '<div style="display:flex;gap:6px;margin-top:8px;flex-wrap:wrap">';
    for (var key in a.reactions) {
      h += '<span style="font-size:11px;background:#f1f5f9;padding:3px 8px;border-radius:99px">' + key + ' ' + a.reactions[key].length + '</span>';
    }
    h += '</div>';
    h += '<div style="margin-top:6px;font-size:10px;color:#94a3b8">ğŸ‘€ æ—¢èª­ ' + a.reads.length + '/' + STAFF.length + '</div>';
    h += '</div>';
    return h;
  }

  // List
  var sorted = ANNOUNCEMENTS.slice().sort(function(a,b) {
    if (a.is_pinned !== b.is_pinned) return b.is_pinned ? 1 : -1;
    var po = { high: 3, normal: 2, low: 1 };
    if (po[a.priority] !== po[b.priority]) return po[b.priority] - po[a.priority];
    return new Date(b.created_at) - new Date(a.created_at);
  });
  for (var i = 0; i < sorted.length; i++) {
    var a = sorted[i];
    if (state.portalFilter !== "all" && a.category !== state.portalFilter) continue;
    var author = getStaff(a.author);
    h += '<div class="card" onclick="state.selectedAnnouncement=ANNOUNCEMENTS.find(function(x){return x.id===\'' + a.id + '\'});render()" style="cursor:pointer">';
    h += '<div style="display:flex;align-items:center;gap:6px;margin-bottom:4px">';
    h += '<span class="priority-dot priority-' + a.priority + '"></span>';
    if (a.is_pinned) h += '<span style="font-size:10px">ğŸ“Œ</span>';
    h += '<span class="badge badge-' + (a.category==="ç·Šæ€¥"?"red":"sky") + '">' + a.category + '</span>';
    h += '<span style="font-size:10px;color:#94a3b8;margin-left:auto">' + fmtDateTime(a.created_at) + '</span>';
    h += '</div>';
    h += '<div class="card-title">' + a.title + '</div>';
    h += '<div class="card-body" style="display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden">' + a.body + '</div>';
    h += '<div style="display:flex;align-items:center;gap:4px;margin-top:6px">';
    h += '<span style="font-size:12px">' + author.avatar + '</span><span style="font-size:10px;color:#94a3b8">' + author.name + '</span>';
    h += '<span style="font-size:10px;color:#94a3b8;margin-left:auto">ğŸ‘€' + a.reads.length + '</span>';
    for (var key in a.reactions) { h += '<span style="font-size:10px">' + key + a.reactions[key].length + '</span>'; }
    h += '</div></div>';
  }
  return h;
}

function renderMeetings() {
  var h = '';
  h += '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px"><h2 style="font-size:16px;font-weight:700">ğŸ¤ ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2></div>';
  
  if (state.selectedMeeting) {
    var m = state.selectedMeeting;
    h += '<button class="btn btn-outline btn-sm" onclick="state.selectedMeeting=null;render()" style="margin-bottom:8px">â† ä¸€è¦§ã«æˆ»ã‚‹</button>';
    h += '<div class="card">';
    h += '<div class="card-title" style="font-size:15px">' + m.title + '</div>';
    h += '<div style="display:flex;gap:8px;margin:8px 0;flex-wrap:wrap">';
    h += '<span class="badge badge-sky">ğŸ“… ' + m.date + '</span>';
    h += '<span class="badge badge-purple">ğŸ• ' + m.time + '</span>';
    h += '<span class="badge badge-slate">ğŸ“ ' + m.location + '</span>';
    h += '</div>';
    h += '<div style="font-size:12px;font-weight:700;color:#334155;margin:10px 0 6px">ğŸ“ è­°é¡Œ</div>';
    for (var i = 0; i < m.agenda.length; i++) {
      var ag = m.agenda[i];
      var tagColor = ag.tag === "å ±å‘Š" ? "sky" : ag.tag === "è­°è«–" ? "amber" : ag.tag === "æ±ºå®š" ? "red" : "green";
      h += '<div style="display:flex;align-items:center;gap:8px;padding:6px 0;border-bottom:1px solid #f1f5f9">';
      h += '<span style="font-size:14px">' + (ag.done ? "âœ…" : "â¬œ") + '</span>';
      h += '<span style="font-size:12px;flex:1">' + ag.text + '</span>';
      h += '<span class="badge badge-' + tagColor + '">' + ag.tag + '</span>';
      h += '</div>';
    }
    h += '<div style="font-size:12px;font-weight:700;color:#334155;margin:10px 0 6px">ğŸ‘¥ å‚åŠ è€…</div>';
    h += '<div style="display:flex;gap:4px;flex-wrap:wrap">';
    for (var j = 0; j < m.attendees.length; j++) {
      var s = getStaff(m.attendees[j]);
      h += '<span style="font-size:11px;background:#f1f5f9;padding:3px 8px;border-radius:99px">' + s.avatar + ' ' + s.name + '</span>';
    }
    h += '</div></div>';
    return h;
  }

  for (var i = 0; i < MEETINGS.length; i++) {
    var m = MEETINGS[i];
    h += '<div class="card" style="cursor:pointer" onclick="state.selectedMeeting=MEETINGS[' + i + '];render()">';
    h += '<div class="card-title">' + m.title + '</div>';
    h += '<div style="display:flex;gap:6px;margin-top:4px">';
    h += '<span class="badge badge-sky">ğŸ“… ' + m.date + '</span>';
    h += '<span class="badge badge-purple">ğŸ• ' + m.time + '</span>';
    h += '</div>';
    h += '<div style="font-size:10px;color:#94a3b8;margin-top:4px">ğŸ“ è­°é¡Œ ' + m.agenda.length + 'ä»¶ ãƒ» ğŸ‘¥ ' + m.attendees.length + 'å</div>';
    h += '</div>';
  }
  return h;
}

function renderHiyari() {
  var h = '';
  h += '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px"><h2 style="font-size:16px;font-weight:700">âš ï¸ ãƒ’ãƒ¤ãƒªãƒãƒƒãƒˆ</h2></div>';
  
  for (var i = 0; i < HIYARIHATTO.length; i++) {
    var hi = HIYARIHATTO[i];
    var sevColor = hi.severity === "é«˜" ? "red" : hi.severity === "ä¸­" ? "amber" : "slate";
    var stColor = hi.status === "å¯¾ç­–æ¸ˆ" ? "green" : hi.status === "å¯¾ç­–ä¸­" ? "amber" : "red";
    h += '<div class="card">';
    h += '<div style="display:flex;align-items:center;gap:6px;margin-bottom:4px">';
    h += '<span class="badge badge-' + sevColor + '">é‡è¦åº¦: ' + hi.severity + '</span>';
    h += '<span class="badge badge-' + stColor + '">' + hi.status + '</span>';
    if (hi.anonymous) h += '<span class="badge badge-purple">ğŸ”’ åŒ¿å</span>';
    h += '<span style="font-size:10px;color:#94a3b8;margin-left:auto">' + hi.created_at + '</span>';
    h += '</div>';
    h += '<div class="card-title">' + hi.title + '</div>';
    h += '<div class="card-body">' + hi.body + '</div>';
    if (!hi.anonymous && hi.author) { var au = getStaff(hi.author); h += '<div style="font-size:10px;color:#94a3b8;margin-top:6px">' + au.avatar + ' ' + au.name + '</div>'; }
    h += '</div>';
  }
  return h;
}

// ============================================================
// INVENTORY TAB
// ============================================================
function renderInventory() {
  var h = '';
  h += '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px"><h2 style="font-size:16px;font-weight:700">ğŸ“¦ åœ¨åº«ç®¡ç†</h2></div>';

  // Search
  h += '<input class="search" placeholder="ğŸ” åœ¨åº«ã‚’æ¤œç´¢..." value="' + state.invSearch + '" oninput="state.invSearch=this.value;render()" style="margin-bottom:8px">';

  // Filter
  h += '<div class="pills">';
  var cats = ["all","æ¶ˆè€—å“","ææ–™","è–¬å“","äºˆé˜²"];
  for (var i = 0; i < cats.length; i++) {
    var c = cats[i];
    var label = c === "all" ? "å…¨ã¦" : c;
    h += '<div class="pill' + (state.invFilter === c ? " active" : "") + '" onclick="state.invFilter=\'' + c + '\';render()">' + label + '</div>';
  }
  h += '</div>';

  // Low stock alert
  var low = INVENTORY.filter(function(i){ return i.stock < i.min_stock; });
  if (low.length > 0) {
    h += '<div style="background:#fef2f2;border:1px solid #fecaca;border-radius:12px;padding:10px;margin-bottom:10px">';
    h += '<div style="font-size:11px;font-weight:700;color:#dc2626;margin-bottom:4px">âš ï¸ åœ¨åº«ä¸è¶³ã‚¢ãƒ©ãƒ¼ãƒˆ</div>';
    for (var i = 0; i < low.length; i++) {
      h += '<div style="font-size:11px;color:#dc2626">â€¢ ' + low[i].name + 'ï¼ˆæ®‹ ' + low[i].stock + ' ' + low[i].unit + ' / åŸºæº– ' + low[i].min_stock + 'ï¼‰</div>';
    }
    h += '</div>';
  }

  // Supplier summary
  h += '<div style="display:flex;gap:6px;margin-bottom:10px;flex-wrap:wrap">';
  for (var i = 0; i < SUPPLIERS.length; i++) {
    var sp = SUPPLIERS[i];
    var cnt = INVENTORY.filter(function(inv){ return inv.supplier === sp.name; }).length;
    h += '<span class="badge badge-slate" style="cursor:pointer" onclick="showToast(\'' + sp.name + ' TEL:' + sp.tel + '\')">' + sp.name + '(' + cnt + ')</span>';
  }
  h += '</div>';

  // Items
  var filtered = INVENTORY.filter(function(inv) {
    var matchCat = state.invFilter === "all" || inv.category === state.invFilter;
    var matchSearch = !state.invSearch || inv.name.toLowerCase().indexOf(state.invSearch.toLowerCase()) >= 0;
    return matchCat && matchSearch;
  });

  for (var i = 0; i < filtered.length; i++) {
    var inv = filtered[i];
    var isLow = inv.stock < inv.min_stock;
    h += '<div class="inv-item" style="' + (isLow ? "border-color:#fecaca;background:#fffbeb" : "") + '">';
    h += '<div class="inv-icon">' + (inv.category === "æ¶ˆè€—å“" ? "ğŸ§¤" : inv.category === "ææ–™" ? "ğŸ¦·" : inv.category === "è–¬å“" ? "ğŸ’Š" : "ğŸ›¡") + '</div>';
    h += '<div class="inv-info"><div class="inv-name">' + inv.name + '</div>';
    h += '<div class="inv-meta">' + inv.category + ' ãƒ» ' + inv.supplier + '</div></div>';
    h += '<div class="inv-stock"><div class="inv-num" style="color:' + (isLow ? "#dc2626" : "#1e293b") + '">' + inv.stock + '</div>';
    h += '<div class="inv-unit">' + inv.unit + ' / ' + inv.min_stock + '</div></div>';
    h += '</div>';
  }
  return h;
}

// ============================================================
// MANUAL TAB
// ============================================================
function renderManual() {
  var h = '';

  if (state.selectedManual) {
    var m = state.selectedManual;
    h += '<button class="btn btn-outline btn-sm" onclick="state.selectedManual=null;render()" style="margin-bottom:8px">â† ä¸€è¦§ã«æˆ»ã‚‹</button>';
    h += '<div class="card">';
    h += '<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">';
    h += '<span style="font-size:24px">' + m.icon + '</span>';
    h += '<div><div class="card-title" style="font-size:15px">' + m.title + '</div>';
    h += '<div style="display:flex;gap:4px;margin-top:2px"><span class="badge badge-sky">' + m.category + '</span><span style="font-size:10px;color:#94a3b8">æ›´æ–°: ' + m.updated_at + '</span></div></div></div>';
    if (m.tags) { h += '<div style="margin-bottom:8px">'; for (var j = 0; j < m.tags.length; j++) h += '<span class="tag">#' + m.tags[j] + '</span> '; h += '</div>'; }
    // Blocks
    for (var j = 0; j < m.blocks.length; j++) {
      var b = m.blocks[j];
      if (b.type === "text") {
        h += '<div class="block-text">' + renderMd(b.value) + '</div>';
      } else if (b.type === "image") {
        h += '<img class="block-img" src="' + b.value + '" alt="' + (b.name||"") + '">';
      } else if (b.type === "video") {
        h += '<div style="background:#f3e8ff;border-radius:10px;padding:20px;text-align:center;margin:8px 0;border:1px solid #e2e8f0"><div style="font-size:28px">ğŸ¬</div><div style="font-size:11px;color:#7c3aed;margin-top:4px">' + (b.name||"å‹•ç”»") + '</div><div style="font-size:10px;color:#94a3b8">ï¼ˆãƒ‡ãƒ¢ç‰ˆã§ã¯å‹•ç”»å†ç”Ÿä¸å¯ï¼‰</div></div>';
      }
    }
    h += '</div>';
    return h;
  }

  h += '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px"><h2 style="font-size:16px;font-weight:700">ğŸ“– ãƒãƒ‹ãƒ¥ã‚¢ãƒ«</h2></div>';

  // Search
  h += '<input class="search" placeholder="ğŸ” ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚’æ¤œç´¢..." value="' + state.manualSearch + '" oninput="state.manualSearch=this.value;render()" style="margin-bottom:8px">';

  // Filter
  h += '<div class="pills">';
  var cats = ["all","æ¥­å‹™æ‰‹é †","æ©Ÿå™¨æ“ä½œ","ç·Šæ€¥å¯¾å¿œ"];
  for (var i = 0; i < cats.length; i++) {
    var c = cats[i];
    h += '<div class="pill' + (state.manualFilter === c ? " active" : "") + '" onclick="state.manualFilter=\'' + c + '\';render()">' + (c === "all" ? "å…¨ã¦" : c) + '</div>';
  }
  h += '</div>';

  var filtered = MANUALS.filter(function(m) {
    var matchCat = state.manualFilter === "all" || m.category === state.manualFilter;
    var matchSearch = !state.manualSearch || m.title.toLowerCase().indexOf(state.manualSearch.toLowerCase()) >= 0;
    return matchCat && matchSearch;
  });

  for (var i = 0; i < filtered.length; i++) {
    var m = filtered[i];
    h += '<div class="card" style="cursor:pointer;display:flex;align-items:center;gap:10px" onclick="state.selectedManual=MANUALS.find(function(x){return x.id===\'' + m.id + '\'});render()">';
    h += '<span style="font-size:22px;flex-shrink:0">' + m.icon + '</span>';
    h += '<div style="flex:1;min-width:0"><div class="card-title" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap">' + m.title + '</div>';
    h += '<div style="display:flex;gap:4px;margin-top:2px;flex-wrap:wrap">';
    h += '<span class="badge badge-sky">' + m.category + '</span>';
    if (m.job_level && m.job_level !== "all") h += '<span class="badge badge-purple">ğŸ”’ ' + m.job_level + '</span>';
    h += '<span style="font-size:10px;color:#94a3b8">æ›´æ–°: ' + m.updated_at + '</span></div>';
    if (m.tags) { h += '<div style="margin-top:2px">'; for (var j = 0; j < Math.min(m.tags.length,3); j++) h += '<span class="tag">#' + m.tags[j] + '</span> '; h += '</div>'; }
    h += '</div><span style="color:#cbd5e1">â†’</span></div>';
  }
  return h;
}

function renderMd(t) {
  return t.replace(/^## (.+)$/gm,'<div style="font-size:14px;font-weight:700;color:#1e293b;margin:10px 0 6px">$1</div>')
    .replace(/^### (.+)$/gm,'<div style="font-size:12px;font-weight:700;color:#334155;margin:8px 0 4px">$1</div>')
    .replace(/^- (.+)$/gm,'<div style="font-size:12px;color:#475569;padding:2px 0 2px 12px">â€¢ $1</div>')
    .replace(/^\d+\. (.+)$/gm,'<div style="font-size:12px;color:#475569;padding:2px 0 2px 12px">$&</div>')
    .replace(/\n/g,'<br>');
}

// ============================================================
// SHIFT TAB
// ============================================================
function renderShift() {
  var h = '';
  var year = state.shiftYear;
  var month = state.shiftMonth;
  var monthNames = ["1æœˆ","2æœˆ","3æœˆ","4æœˆ","5æœˆ","6æœˆ","7æœˆ","8æœˆ","9æœˆ","10æœˆ","11æœˆ","12æœˆ"];
  
  h += '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">';
  h += '<h2 style="font-size:16px;font-weight:700">ğŸ“… ã‚·ãƒ•ãƒˆç®¡ç†</h2>';
  h += '</div>';

  // Month navigation
  h += '<div style="display:flex;align-items:center;justify-content:center;gap:16px;margin-bottom:12px">';
  h += '<button class="btn btn-outline btn-sm" onclick="prevMonth()">â—€</button>';
  h += '<span style="font-size:14px;font-weight:700">' + year + 'å¹´ ' + monthNames[month] + '</span>';
  h += '<button class="btn btn-outline btn-sm" onclick="nextMonth()">â–¶</button>';
  h += '</div>';

  if (state.shiftDate) {
    h += renderDayShift(state.shiftDate);
    return h;
  }

  // Calendar
  var firstDay = new Date(year, month, 1).getDay();
  var daysInMonth = new Date(year, month + 1, 0).getDate();
  var today = new Date();
  var todayStr = today.getFullYear() + "-" + String(today.getMonth()+1).padStart(2,"0") + "-" + String(today.getDate()).padStart(2,"0");

  h += '<div class="cal-grid">';
  var dayLabels = ["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"];
  for (var d = 0; d < 7; d++) h += '<div class="cal-header" style="color:' + (d===0?"#dc2626":d===6?"#0284c7":"#64748b") + '">' + dayLabels[d] + '</div>';

  for (var i = 0; i < firstDay; i++) h += '<div class="cal-day empty"></div>';

  for (var d = 1; d <= daysInMonth; d++) {
    var dateStr = year + "-" + String(month+1).padStart(2,"0") + "-" + String(d).padStart(2,"0");
    var shifts = SHIFTS_FEB[dateStr] || [];
    var isToday = dateStr === todayStr;
    var cls = "cal-day";
    if (isToday) cls += " today";
    else if (shifts.length > 0 && shifts.length < 3) cls += " short";
    else if (shifts.length >= 3) cls += " has-shift";
    
    h += '<div class="' + cls + '" onclick="state.shiftDate=\'' + dateStr + '\';render()" style="cursor:pointer">';
    h += '<div style="font-size:12px">' + d + '</div>';
    if (shifts.length > 0) h += '<div style="font-size:8px;color:' + (shifts.length < 3 ? "#d97706" : "#16a34a") + '">' + shifts.length + 'å</div>';
    h += '</div>';
  }
  h += '</div>';

  // Legend
  h += '<div style="display:flex;gap:12px;margin-top:8px;justify-content:center">';
  h += '<span style="font-size:10px;color:#94a3b8"><span style="display:inline-block;width:10px;height:10px;background:#dcfce7;border:1px solid #bbf7d0;border-radius:3px;margin-right:3px;vertical-align:middle"></span>3åä»¥ä¸Š</span>';
  h += '<span style="font-size:10px;color:#94a3b8"><span style="display:inline-block;width:10px;height:10px;background:#fef3c7;border:1px solid #fde68a;border-radius:3px;margin-right:3px;vertical-align:middle"></span>äººå“¡ä¸è¶³</span>';
  h += '</div>';

  return h;
}

function renderDayShift(dateStr) {
  var h = '';
  h += '<button class="btn btn-outline btn-sm" onclick="state.shiftDate=null;render()" style="margin-bottom:8px">â† ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«æˆ»ã‚‹</button>';
  h += '<div class="card"><div class="card-title" style="margin-bottom:10px">ğŸ“… ' + dateStr + ' ã®ã‚·ãƒ•ãƒˆ</div>';

  var shifts = SHIFTS_FEB[dateStr] || [];
  if (shifts.length === 0) {
    h += '<div style="text-align:center;padding:20px;color:#94a3b8;font-size:12px">ã‚·ãƒ•ãƒˆç™»éŒ²ãªã—</div>';
  } else {
    // Timeline header
    h += '<div style="display:flex;align-items:center;margin-bottom:4px"><div style="width:60px"></div><div style="flex:1;display:flex;justify-content:space-between;font-size:9px;color:#94a3b8;padding:0 2px"><span>9:00</span><span>12:00</span><span>15:00</span><span>18:00</span></div></div>';
    for (var i = 0; i < shifts.length; i++) {
      var sh = shifts[i];
      var s = getStaff(sh.staff);
      var startH = parseInt(sh.start.split(":")[0]);
      var endH = parseInt(sh.end.split(":")[0]);
      var left = ((startH - 9) / 10 * 100);
      var width = ((endH - startH) / 10 * 100);
      var colors = ["#0284c7","#16a34a","#7c3aed","#d97706","#dc2626","#db2777"];
      h += '<div class="shift-row"><div class="shift-name">' + s.avatar + ' ' + s.name.split(" ")[1] + '</div>';
      h += '<div class="shift-bar-wrap"><div class="shift-bar" style="left:' + left + '%;width:' + width + '%;background:' + colors[i%6] + '">' + sh.start + '-' + sh.end + '</div></div></div>';
    }
  }
  h += '<div style="margin-top:8px;font-size:11px;color:#64748b">å‡ºå‹¤: <strong>' + shifts.length + 'å</strong></div>';
  if (shifts.length < 3) h += '<div style="font-size:11px;color:#d97706;margin-top:2px">âš ï¸ äººå“¡ä¸è¶³ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™</div>';
  h += '</div>';
  return h;
}

function prevMonth() { state.shiftMonth--; if(state.shiftMonth < 0){state.shiftMonth=11;state.shiftYear--;} state.shiftDate=null; render(); }
function nextMonth() { state.shiftMonth++; if(state.shiftMonth > 11){state.shiftMonth=0;state.shiftYear++;} state.shiftDate=null; render(); }

// ============================================================
// THANK YOU TAB
// ============================================================
function renderThankYou() {
  var h = '';
  h += '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px"><h2 style="font-size:16px;font-weight:700">ğŸ’Œ ã‚ã‚ŠãŒã¨ã†ã‚«ãƒ¼ãƒ‰</h2></div>';

  // Sub tabs
  h += '<div class="sub-tabs">';
  h += '<div class="sub-tab' + (state.tyTab === "received" ? " active" : "") + '" onclick="state.tyTab=\'received\';render()">ğŸ“¥ ã‚‚ã‚‰ã£ãŸ</div>';
  h += '<div class="sub-tab' + (state.tyTab === "sent" ? " active" : "") + '" onclick="state.tyTab=\'sent\';render()">ğŸ“¤ é€ã£ãŸ</div>';
  h += '<div class="sub-tab' + (state.tyTab === "ranking" ? " active" : "") + '" onclick="state.tyTab=\'ranking\';render()">ğŸ‘‘ ãƒ©ãƒ³ã‚­ãƒ³ã‚°</div>';
  h += '</div>';

  if (state.tyTab === "ranking") {
    // Count received
    var counts = {};
    for (var i = 0; i < THANKYOU.length; i++) {
      var c = THANKYOU[i].to;
      counts[c] = (counts[c] || 0) + 1;
    }
    var sorted = Object.keys(counts).sort(function(a,b){ return counts[b]-counts[a]; });
    var medals = ["ğŸ¥‡","ğŸ¥ˆ","ğŸ¥‰"];
    for (var i = 0; i < sorted.length; i++) {
      var s = getStaff(sorted[i]);
      h += '<div class="rank-item"><div class="rank-medal">' + (medals[i]||"") + '</div>';
      h += '<span style="font-size:16px">' + s.avatar + '</span>';
      h += '<div class="rank-name">' + s.name + '</div>';
      h += '<div class="rank-count">' + counts[sorted[i]] + ' æš</div></div>';
    }
    // Send stats
    h += '<div style="margin-top:12px;font-size:12px;font-weight:700;color:#334155;margin-bottom:6px">ğŸ“Š é€ä¿¡çŠ¶æ³</div>';
    for (var i = 0; i < STAFF.length; i++) {
      var s = STAFF[i];
      var sent = THANKYOU.filter(function(t){ return t.from === s.id; }).length;
      var pct = Math.min(sent / 10 * 100, 100);
      h += '<div style="display:flex;align-items:center;gap:8px;padding:4px 0"><span style="font-size:12px;width:20px">' + s.avatar + '</span>';
      h += '<span style="font-size:11px;width:70px;flex-shrink:0">' + s.name.split(" ")[1] + '</span>';
      h += '<div class="progress-bar" style="flex:1"><div class="progress-fill" style="width:' + pct + '%;background:#0284c7"></div></div>';
      h += '<span style="font-size:10px;color:#64748b;width:35px;text-align:right">' + sent + '/10</span></div>';
    }
    return h;
  }

  var cards = THANKYOU.filter(function(t) {
    if (state.tyTab === "received") return t.to === currentUser.id;
    return t.from === currentUser.id;
  });

  if (cards.length === 0) {
    h += '<div style="text-align:center;padding:30px;color:#94a3b8"><div style="font-size:36px;margin-bottom:8px">ğŸ’Œ</div><div style="font-size:12px">ã‚«ãƒ¼ãƒ‰ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“</div></div>';
    return h;
  }

  for (var i = 0; i < cards.length; i++) {
    var c = cards[i];
    var from = getStaff(c.from);
    var to = getStaff(c.to);
    h += '<div class="ty-card">';
    h += '<div style="display:flex;align-items:center;justify-content:space-between"><span class="ty-emoji">' + c.emoji + '</span>';
    h += '<span style="font-size:10px;color:#94a3b8">' + fmtDateTime(c.created_at) + '</span></div>';
    h += '<div class="ty-msg">' + c.message + '</div>';
    h += '<div class="ty-from">' + (state.tyTab === "received" ? "From: " + from.avatar + " " + from.name : "To: " + to.avatar + " " + to.name) + '</div>';
    h += '</div>';
  }
  return h;
}

// ============================================================
// STAFF MANAGEMENT TAB
// ============================================================
function renderStaffManagement() {
  var h = '';

  // Sub tabs
  h += '<div class="sub-tabs">';
  h += '<div class="sub-tab' + (state.leaveTab === "list" ? " active" : "") + '" onclick="state.leaveTab=\'list\';render()">ğŸ‘¥ ã‚¹ã‚¿ãƒƒãƒ•</div>';
  h += '<div class="sub-tab' + (state.leaveTab === "leave" ? " active" : "") + '" onclick="state.leaveTab=\'leave\';render()">ğŸ– æœ‰çµ¦ç®¡ç†</div>';
  h += '</div>';

  if (state.leaveTab === "leave") return h + renderPaidLeave();

  h += '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px"><h2 style="font-size:16px;font-weight:700">ğŸ‘¥ ã‚¹ã‚¿ãƒƒãƒ•ä¸€è¦§</h2></div>';

  for (var i = 0; i < STAFF.length; i++) {
    var s = STAFF[i];
    var leave = PAID_LEAVE.find(function(l){ return l.id === s.id; }) || { total: 0, used: 0 };
    h += '<div class="card" style="display:flex;align-items:center;gap:10px">';
    h += '<span style="font-size:28px">' + s.avatar + '</span>';
    h += '<div style="flex:1"><div style="font-size:13px;font-weight:700">' + s.name + '</div>';
    h += '<div style="display:flex;gap:4px;margin-top:2px">';
    h += '<span class="badge badge-sky">' + s.job + '</span>';
    h += '<span class="badge ' + (s.role === "admin" ? "badge-purple" : "badge-slate") + '">' + (s.role === "admin" ? "ç®¡ç†è€…" : "ã‚¹ã‚¿ãƒƒãƒ•") + '</span>';
    h += '</div>';
    h += '<div style="font-size:10px;color:#94a3b8;margin-top:2px">å…¥è·: ' + s.joined + ' ãƒ» æœ‰çµ¦æ®‹: ' + (leave.total - leave.used) + 'æ—¥</div>';
    h += '</div></div>';
  }
  return h;
}

function renderPaidLeave() {
  var h = '';
  h += '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px"><h2 style="font-size:16px;font-weight:700">ğŸ– æœ‰çµ¦ç®¡ç†</h2></div>';

  for (var i = 0; i < STAFF.length; i++) {
    var s = STAFF[i];
    var leave = PAID_LEAVE.find(function(l){ return l.id === s.id; }) || { total: 0, used: 0, history: [] };
    var remaining = leave.total - leave.used;
    var pct = leave.total > 0 ? (remaining / leave.total * 100) : 0;
    var color = pct > 50 ? "#16a34a" : pct > 20 ? "#d97706" : "#dc2626";

    h += '<div class="card">';
    h += '<div style="display:flex;align-items:center;gap:8px;margin-bottom:6px">';
    h += '<span style="font-size:18px">' + s.avatar + '</span>';
    h += '<span style="font-size:12px;font-weight:700;flex:1">' + s.name + '</span>';
    h += '<span style="font-size:14px;font-weight:700;color:' + color + '">' + remaining + 'æ—¥</span>';
    h += '<span style="font-size:10px;color:#94a3b8">/ ' + leave.total + 'æ—¥</span>';
    h += '</div>';
    h += '<div class="progress-bar"><div class="progress-fill" style="width:' + pct + '%;background:' + color + '"></div></div>';
    if (leave.history.length > 0) {
      h += '<div style="margin-top:6px">';
      for (var j = 0; j < Math.min(leave.history.length, 2); j++) {
        var hist = leave.history[j];
        h += '<div style="font-size:10px;color:#94a3b8;padding:1px 0">ğŸ“… ' + hist.date + ' (' + hist.days + 'æ—¥) - ' + hist.reason + '</div>';
      }
      h += '</div>';
    }
    h += '</div>';
  }
  return h;
}

// --- Initial Render ---
render();
</script>
</body>
</html>
